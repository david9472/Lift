<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="stylesheet" href="css/base.css" />
        <link rel="stylesheet" href="css/layout.css" />
        <link rel="stylesheet" href="css/legal.css" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Terms of Service - Lift</title>
    </head>
    <body>
        <nav>
            <div class="nav-content">
                <div class="logo">Lift</div>
                <a href="index.html" class="download-btn">Back to Home</a>
            </div>
        </nav>

        <!-- Terms of Service Content -->
        <div class="legal-content">
            <a href="index.html" class="back-link">‚Üê Back to Lift</a>
            <main class="policy-container">
              <header>
                <h1 id="policy-title" class="policy-title"></h1>
                <p id="policy-updated" class="policy-meta"></p>
              </header>

              <article id="policy-root">
                <!-- Sections will be injected here while keeping the CSS hooks -->
              </article>
            </main>
        </div>

      <script>
        const topic = 'privacy-policy';

        function resolveLanguage() {
          const lang = (navigator.language || 'en').slice(0, 2).toLowerCase();
          return lang === 'de' ? 'de' : 'en';
        }

        async function loadPolicy() {
          const lang = resolveLanguage();
          const url = `${topic}-${lang}.json`;

          try {
            const response = await fetch(url, { cache: 'no-store' });
            if (!response.ok) throw new Error(`HTTP ${response.status}`);
            const policy = await response.json();
            renderPolicy(policy);
          } catch (error) {
            console.error('Policy load failed:', error);
            document.getElementById('policy-root').textContent =
              'The policy is temporarily unavailable.';
          }
        }

        function renderPolicy(policy) {
          document.getElementById('policy-title').textContent = policy.title;
          document.getElementById('policy-updated').textContent =
            `Last updated: ${policy.lastUpdated}`;

          const root = document.getElementById('policy-root');
          root.innerHTML = '';
          policy.sections?.forEach(section => {
            root.appendChild(renderSection(section));
          });
        }

        function renderSection(section) {
          const wrapper = document.createElement('section');
          wrapper.className = `policy-section ${section.blockType || 'default'}`;

          if (section.heading) {
            const heading = document.createElement('h2');
            heading.className = 'policy-heading';
            heading.textContent = section.heading;
            wrapper.appendChild(heading);
          }

          if (section.content) {
            const paragraph = document.createElement('p');
            paragraph.className = 'policy-text';
            paragraph.textContent = section.content;
            wrapper.appendChild(paragraph);
          }

          if (section.items?.length) {
            const list = document.createElement(
              section.listType === 'numbered' ? 'ol' : 'ul'
            );
            list.className = 'policy-list';
            section.items.forEach(item => {
              const li = document.createElement('li');
              li.textContent = item;
              list.appendChild(li);
            });
            wrapper.appendChild(list);
          }

          section.sections?.forEach(child => {
            wrapper.appendChild(renderSection(child));
          });

          return wrapper;
        }

        loadPolicy();
      </script>
      <footer>
          <div class="container">
              <div class="footer-bottom">
                  <p>&copy; 2025 Lift. All rights reserved.</p>
                  <p class="footer-legal">
                      <a href="privacy-policy.html">Privacy Policy</a>
                      <span class="separator">|</span>
                      <a href="terms-of-service.html">Terms of Use</a>
                  </p>
              </div>
          </div>
      </footer>
    </body>
    </html>
</html>
